function GetUrlParms(){var i=new Object();var k=new Array("page","sort","ob","so","b","w","t","s");var j=window.location.pathname;var f=j.split("/");var c=f[f.length-1];var a=c.length;var g=c.lastIndexOf(".");if(g>0){a=g}var b=c.substr(0,a);var h=b.split("_");for(var l in h){for(var e in k){var d=h[l].indexOf(k[e]);if(d===0){i[k[e]]=unescape(h[l].substr(k[e].length));break}}}return i}function addParmReturnUrl(e,d){d=d||false;var c=GetUrlParms();if(!e.hasOwnProperty("page")){c.page=1}var g="/diapers/";if(typeof e=="string"&&d){delete c[e]}else{c=$.extend({},c,e)}var f=new Object();f.b="";f.w="";f.s="";f.t="";f.so="";f.ob="";f.sort="";f.page="";for(var a in c){f[a]=c[a]}for(var b in f){if(f[b]!==""){g+=b+c[b]+"_"}}g=g.replace(/(_*$)/g,"");return g+".html"}function goIndexPage(){window.location.href="/diapers.html"}var getEleByParm=function(a){var b={b:"se_brand",t:"se_type",s:"se_size",w:"se_weight"};return b[a]};var createBlcock=function(b,a){$("#nfTerm").find("dd").append('<span class="sedot"></span><a href="#" class="seterm" data-type="'+b+'"><span>'+a+"</span><i></i></a>")};var initSearchTerm=function(){var n=$("#nfBox");var j=GetUrlParms();var a=false;for(var d in j){a=true;var e=getEleByParm(d);if(e&&j[d]){var f=$("#"+e);f.css("display","none");if(d=="w"){var m=parseInt(j[d]);if(m<0||m>30){continue}createBlcock(d,m+"kg");continue}var h=f.find('[data-value="'+j[d]+'"]');if(h.length){createBlcock(d,h.text())}}}if(!a){}var l=$("#nfTerm").find("dd").find(".sedot:eq(0)");if(!l.length){$("#nfTerm").data("hidden","1").css("display","none");$("#nfBox").css("marginBottom","15px")}else{l.remove();$("#nfTerm").find("dd").find("a.seterm:last").prop("class","seterm-on");if(j.hasOwnProperty("b")){n.removeClass("nfBox")}}var i=j.ob;if(i){var b=j.sort;var c=$("#nfBar").find('.sbtn[data-value="'+i+'"]').addClass("cur");if(b=="asc"){c.find("i").addClass("asc")}c=null}else{$("#nfBar").find(".sbtn:first").addClass("cur")}var g=j.so;if(g>0){$("#goods").prop("checked",true)}};$(function(){function b(){var d=$(document).width();$(".nfFocus li").css("width",d)}b();$(window).resize(b);$(".filtBox .bitem").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")});initSearchTerm();$(window).scroll(function(){var f=$("#nfFilt"),g=$("#nfBar"),i=$("#nfBox"),h=$("#nfTerm");var d=$(this).scrollTop();var k=$("#nfWrap").offset().top;var j=i.data("isdeal"),l=h.data("isdeal");var e=!h.data("hidden");if(d>=k){f.addClass("nfFilt");g.slideDown(200);if(!j&&!l){i.data("isdeal","1").css("display","none");if(e){h.data("isdeal","1").css("display","none")}}}else{f.removeClass("nfFilt");i.data("isdeal","").css("display","block");if(e){h.data("isdeal","").css("display","block")}}});$("#filtMore").on("click",function(){var f=$(this),d=$("#nfBox");var e=f.data("isopen");if(!e){f.data("isopen","1");d.slideDown(200)}else{f.data("isopen","");d.css("display","none")}});$("#brandMore").on("click",function(){var g=$(this),f=$("#nfBox"),e=$("#nfWrap").find(".brand-logo");var d=g.data("isopen");g.blur();if(!d){g.data("isopen","1");g.addClass("cur");f.removeClass("nfBox");e.removeClass("nfLogo");return false}g.data("isopen","");g.removeClass("cur");f.addClass("nfBox");e.addClass("nfLogo")});$("#nfTerm").on("click","a",function(){var e=$(this);if(e.prop("class")=="sedelall"){goIndexPage();return false}if($("#nfTerm").find("a").length<=2){goIndexPage();return false}var d=e.data("type");if(!d){return false}window.location.href=addParmReturnUrl(d,true)});$("#nfBox").on("click",".bitem",function(){var d=$(this);var e={};e[d.data("type")]=d.data("value");window.location.href=addParmReturnUrl(e)}).on("click","a",function(){var d=$(this);if(!d.data("type")){return false}var e={};e[d.data("type")]=d.data("value");window.location.href=addParmReturnUrl(e)});$(".pager").on("click","a",function(){var d=parseFloat($(this).data("page"))||1;var e={};e.page=d;window.location.href=addParmReturnUrl(e)});$("#nfBar").on("click",".sbtn",function(){var f=$(this);var d=f.data("type"),g=f.data("value");var e={};e[d]=g;if(f.find("i").hasClass("asc")||!f.hasClass("cur")){e.sort="desc"}else{e.sort="asc"}window.location.href=addParmReturnUrl(e)});$("#goods").on("change",function(){var d={};if(this.checked){d.so=1}else{d.so=0}window.location.href=addParmReturnUrl(d)});var c=300;var a=10;$("#gragbtn").draggable({axis:"x",containment:"parent",drag:function(f,h){var g=$("#se_weight .cross");var e=h.position.left;g.css("width",e+"px");var d=Math.ceil(e/a);if(e>300){$(f.target).css("left","300px");d=30}$(f.target).find("span").text(d)},stop:function(e,f){var d=$(e.target).data("type"),h=$(e.target).find("span").text();var g={};g[d]=h;window.location.href=addParmReturnUrl(g)}})});