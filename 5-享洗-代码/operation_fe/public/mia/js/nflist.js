function GetUrlParms(){var i=new Object();var k=new Array("page","sort","ob","so","b","f","c");var j=window.location.pathname;var f=j.split("/");var c=f[f.length-1];var a=c.length;var g=c.lastIndexOf(".");if(g>0){a=g}var b=c.substr(0,a);var h=b.split("_");for(var l in h){for(var e in k){var d=h[l].indexOf(k[e]);if(d===0){i[k[e]]=unescape(h[l].substr(k[e].length));break}}}return i}function addParmReturnUrl(e,d){d=d||false;var c=GetUrlParms();if(!e.hasOwnProperty("page")){c.page=1}var g="/formulasList/";if(typeof e=="string"&&d){delete c[e]}else{c=$.extend({},c,e)}var f=new Object();f.c="";f.b="";f.f="";f.so="";f.ob="";f.sort="";f.page="";for(var a in c){f[a]=c[a]}for(var b in f){if(f[b]!==""){g+=b+c[b]+"_"}}g=g.replace(/(_*$)/g,"");return g+".html"}function goIndexPage(){window.location.href="/formulas.html"}var getEleByParm=function(a){var b={b:"se_brand",f:"se_age",c:"se_addr"};return b[a]};var initSearchTerm=function(){var n=$("#nfBox");var l=GetUrlParms();var a=false;for(var d in l){a=true;var e=getEleByParm(d);if(e&&l[d]){var f=$("#"+e);f.css("display","none");var i=f.find('[data-value="'+l[d]+'"]');if(i.length){var h='<span class="sedot"></span><a href="#" class="seterm" data-type="'+d+'"><span>'+i.text()+"</span><i></i></a>";$("#nfTerm").find("dd").append(h)}}}if(!a){goIndexPage();return false}var m=$("#nfTerm").find("dd").find(".sedot:eq(0)");if(!m.length){$("#nfTerm").data("hidden","1").css("display","none");$("#nfBox").css("marginBottom","15px")}else{m.remove();$("#nfTerm").find("dd").find("a.seterm:last").prop("class","seterm-on");if(l.hasOwnProperty("b")){n.removeClass("nfBox")}}var j=l.ob;if(j){var b=l.sort;var c=$("#nfBar").find('.sbtn[data-value="'+j+'"]').addClass("cur");if(b=="asc"){c.find("i").addClass("asc")}c=null}else{$("#nfBar").find(".sbtn:first").addClass("cur")}var g=l.so;if(g>0){$("#goods").prop("checked",true)}};(function(){function a(){var b=$(document).width();$(".nfFocus li").css("width",b)}a();$(window).resize(a);$(".filtBox .bitem").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")});initSearchTerm();$(window).scroll(function(){var d=$("#nfFilt"),e=$("#nfBar"),g=$("#nfBox"),f=$("#nfTerm");var b=$(this).scrollTop();var i=$("#nfWrap").offset().top;var h=g.data("isdeal"),j=f.data("isdeal");var c=!f.data("hidden");if(b>=i){d.addClass("nfFilt");e.slideDown(200);if(!h&&!j){g.data("isdeal","1").css("display","none");if(c){f.data("isdeal","1").css("display","none")}}}else{d.removeClass("nfFilt");g.data("isdeal","").css("display","block");if(c){f.data("isdeal","").css("display","block")}}});$("#filtMore").on("click",function(){var d=$(this),b=$("#nfBox");var c=d.data("isopen");if(!c){d.data("isopen","1");b.slideDown(200)}else{d.data("isopen","");b.css("display","none")}});$("#brandMore").on("click",function(){var e=$(this),d=$("#nfBox"),c=$("#nfWrap").find(".brand-logo");var b=e.data("isopen");e.blur();if(!b){e.data("isopen","1");e.addClass("cur");d.removeClass("nfBox");c.removeClass("nfLogo");return false}e.data("isopen","");e.removeClass("cur");d.addClass("nfBox");c.addClass("nfLogo")});$("#nfTerm").on("click","a",function(){var c=$(this);if(c.prop("class")=="sedelall"){goIndexPage();return false}if($("#nfTerm").find("a").length<=2){goIndexPage();return false}var b=c.data("type");if(!b){return false}window.location.href=addParmReturnUrl(b,true)});$("#nfBox").on("click",".bitem",function(){var b=$(this);var c={};c[b.data("type")]=b.data("value");window.location.href=addParmReturnUrl(c)}).on("click","a",function(){var b=$(this);if(!b.data("type")){return false}var c={};c[b.data("type")]=b.data("value");window.location.href=addParmReturnUrl(c)});$(".pager").on("click","a",function(){var b=parseFloat($(this).data("page"))||1;var c={};c.page=b;window.location.href=addParmReturnUrl(c)});$("#nfBar").on("click",".sbtn",function(){var d=$(this);var b=d.data("type"),e=d.data("value");var c={};c[b]=e;if(d.find("i").hasClass("asc")||!d.hasClass("cur")){c.sort="desc"}else{c.sort="asc"}window.location.href=addParmReturnUrl(c)});$("#goods").on("change",function(){var b={};if(this.checked){b.so=1}else{b.so=0}window.location.href=addParmReturnUrl(b)})})();