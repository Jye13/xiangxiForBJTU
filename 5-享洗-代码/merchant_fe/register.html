<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title id="title">享洗小组-工厂注册</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Bootstrap 3.3.5 -->
    <link rel="stylesheet" href="./public/admin/bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="./public/admin/bootstrap/css/font-awesome.min.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="./public/admin/bootstrap/css/ionicons.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="./public/admin/dist/css/AdminLTE.min.css">
    <!-- iCheck -->
    <link rel="stylesheet" href="./public/admin/plugins/iCheck/square/blue.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link href="./public/html5upload/css/default.css" rel="stylesheet" type="text/css" />
    <link href="./public/html5upload/css/fileinput.css" media="all" rel="stylesheet" type="text/css" />

    <style>
        .login-box, .register-box {
            width: 50%;
            margin: 2% auto;
        }
    </style>
<script src="./public/config.js"></script></head>
<body class="hold-transition register-page">
<div class="register-box">
    <div class="register-logo">
        <a href="javascript:void(0)"><b>Merchant</b>Register</a>
    </div>

    <div class="register-box-body">
        <p class="login-box-msg">工厂注册</p>

        <form id="registerForm" action="" method="post" enctype="multipart/form-data">

            <div class="form-group has-feedback">
                <input type="password" name="password" class="form-control" placeholder="密码">
                <span class="glyphicon glyphicon-lock form-control-feedback"></span>
            </div>
            <div class="form-group has-feedback">
                <input type="password" name="repassword" class="form-control" placeholder="再输一次密码">
                <span class="glyphicon glyphicon-log-in form-control-feedback"></span>
            </div>

            <hr class="box box-info" />
            <h4 style="text-align:center;">工厂信息</h4>
            <div class="form-group has-feedback">
                <label for="name">工厂名称</label>
                <input type="text" name="nick" class="form-control"  value="" placeholder="工厂名称">
                <span class="glyphicon glyphicon-home form-control-feedback"></span>
            </div>
            <div class="form-group has-feedback">
                <label class="control-label">工厂LOGO</label>
                <input id="logo" name="logo" type="file" accept="image/*" class="file-loading">
                <div id="errorBlock" class="help-block"></div>
            </div>
            <div class="form-group has-feedback">
                <label for="comment">工厂描述</label>
                <textarea name="comment" class="form-control" value="" placeholder="工厂描述"></textarea>
            </div>

            <hr class="box box-info" />
            <h4 style="text-align:center;">工厂负责人信息</h4>
            <div class="form-group has-feedback">
                <label for="comment">真实姓名</label>
                <input type="text" name="rename" value="" class="form-control" placeholder="真实姓名">
            </div>
            <div class="form-group">
                <label for="comment">性别</label>
                &nbsp;&nbsp;&nbsp;&nbsp;
                <input type="radio" name="sex" value="0"  class="form-control"> &nbsp;女
                &nbsp;&nbsp;&nbsp;&nbsp;
                <input type="radio" name="sex" value="1" class="form-control"> &nbsp;男
            </div>
            <div class="form-group has-feedback">
                <label for="mobile">手机号码</label>
                <input type="text" id="mobile" name="mobile" value="" class="form-control" placeholder="phone">
                <span class="glyphicon glyphicon-phone form-control-feedback"></span>
            </div>
            <div class="form-group has-feedback">
                <label for="mail">邮箱</label>
                <input type="email" name="mail" value="" class="form-control" placeholder="Email">
                <span class="glyphicon glyphicon-envelope form-control-feedback"></span>
            </div>
            <div class="form-group has-feedback">
                <label class="control-label">营业执照</label>
                <input id="license" name="license" type="file" accept="image/*" class="file-loading">
                <div id="" class="help-block"></div>
            </div>
            <div class="form-group has-feedback">
                <label class="control-label">手持证件照片</label>
                <input id="card" name="card" type="file" accept="image/*" class="file-loading">
                <div id="" class="help-block"></div>
            </div>

            <div class="row">
                <div class="col-xs-8">
                    <div class="checkbox icheck">
                        <label>
                            <input type="checkbox" name="agree" value="1" checked="checked"> I agree to the <a href="#">terms</a>
                        </label>
                    </div>
                </div><!-- /.col -->
                <div class="col-xs-4">
                    <button id="submitButton" type="submit" class="btn btn-primary btn-block btn-flat">Register</button>
                </div><!-- /.col -->
            </div>
        </form>

        <a href="./login.html" class="text-center">已有帐号？登录</a>
    </div><!-- /.form-box -->
</div><!-- /.register-box -->

<!-- jQuery 2.1.4 -->
<script src="./public/admin/plugins/jQuery/jQuery-2.1.4.min.js"></script>
<script src="./public/html5upload/js/fileinput.min.js" type="text/javascript"></script>
<script src="./public/html5upload/js/fileinput_locale_zh.js" type="text/javascript"></script>
<!-- Bootstrap 3.3.5 -->
<script src="./public/admin/bootstrap/js/bootstrap.min.js"></script>
<!-- iCheck -->
<script src="./public/admin/plugins/iCheck/icheck.min.js"></script>
<script>
    function CheckMail(mail) {
        var filter  = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
        if (filter.test(mail)) return true;
        else {
            alert('您的电子邮件格式不正确');
            return false;}
    }
</script>
<script>
    $('#submitButton').click(function(){
        var mail = $('input[name=mail]').val();
        if (CheckMail(mail) == false){
            return;
        }
        var url = hostMerchantUrl + '/send/mail';
        $.ajax({
            cache: true,
            type: "POST",
            url:url,
            cache: false,
            data: new FormData($('#registerForm')[0]),
            processData: false,
            contentType: false,
            async: false,
            error: function(request) {
                alert(request);
                alert("Connection error");
            },
            success: function(data) {
                alert(data.msg);
                if (data.status=='0') {
                    alert("注册成功,请到邮箱进行验证后登录！");
                    window.location.href = "./login.html";
                }else{
                    alert('注册失败，重新来过！');
                }
            }
        });
        return false;
    });
    $(function () {
        $('input').iCheck({
            checkboxClass: 'icheckbox_square-blue',
            radioClass: 'iradio_square-blue',
            increaseArea: '20%' // optional
        });
    });
    $(function () {
        $('input').iCheck({
            checkboxClass: 'icheckbox_square-blue',
            radioClass: 'iradio_square-blue',
            increaseArea: '20%' // optional
        });
    });
    $(document).on('ready', function() {
        var config = {
            uploadUrl: hostMerchantUrl + '/send/mail', // you must set a valid URL here else you will get an error
            allowedFileExtensions : ['jpg', 'png','gif'],
            maxFileSize: 10240,
            maxFilePreviewSize: 10240,
            allowedFileTypes: ['image'],
            allowedPreviewTypes:['image'],
            previewSettings:{
                image: {width: "auto", height: "auto"}
            },
            layoutTemplates:{
                main1: '{preview}\n' +
                '<div class="kv-upload-progress hide"></div>\n' +
                '<div class="input-group {class}">\n' +
                '   {caption}\n' +
                '   <div class="input-group-btn">\n' +
                '       {remove}\n' +
                '       {cancel}\n' +
                '       {upload}\n' +
                '       {browse}\n' +
                '   </div>\n' +
                '</div>',
                main2: '{preview}\n<div class="kv-upload-progress hide"></div>\n{remove}\n{cancel}\n{upload}\n{browse}\n',
                preview: '<div class="file-preview {class}">\n' +
                '    {close}\n' +
                '    <div class="close fileinput-remove">×</div>\n' +
                '    <div class="{dropClass}">\n' +
                '    <div class="file-preview-thumbnails">\n' +
                '    </div>\n' +
                '    <div class="clearfix"></div>' +
                '    <div class="file-preview-status text-center text-success"></div>\n' +
                '    <div class="kv-fileinput-error"></div>\n' +
                '    </div>\n' +
                '</div>',
                icon: '<span class="glyphicon glyphicon-file kv-caption-icon"></span>',
                caption: '<div tabindex="-1" class="form-control file-caption {class}">\n' +
                '   <div class="file-caption-name"></div>\n' +
                '</div>',
                btnDefault: '<button type="{type}" tabindex="500" title="{title}" class="{css}"{status}>{icon}{label}</button>',
                btnLink: '<a href="{href}" tabindex="500" title="{title}" class="{css}"{status}>{icon}{label}</a>',
                btnBrowse: '<div tabindex="500" class="{css}"{status}>{icon}{label}</div>',
                modalMain: '<div id="kvFileinputModal" class="file-zoom-dialog modal fade" tabindex="-1" aria-labelledby="kvFileinputModalLabel"></div>',
                modal: '<div class="modal-dialog modal-lg" role="document">\n' +
                '  <div class="modal-content">\n' +
                '    <div class="modal-header">\n' +
                '      <div class="kv-zoom-actions pull-right">{toggleheader}{fullscreen}{borderless}{close}</div>\n' +
                '      <h3 class="modal-title">{heading} <small><span class="kv-zoom-title"></span></small></h3>\n' +
                '    </div>\n' +
                '    <div class="modal-body">\n' +
                '      <div class="floating-buttons"></div>\n' +
                '      <div class="kv-zoom-body file-zoom-content"></div>\n' + '{prev} {next}\n' +
                '    </div>\n' +
                '  </div>\n' +
                '</div>\n',
                progress: '<div class="progress">\n' +
                '    <div class="progress-bar progress-bar-success progress-bar-striped text-center" role="progressbar" aria-valuenow="{percent}" aria-valuemin="0" aria-valuemax="100" style="width:{percent}%;">\n' +
                '        {percent}%\n' +
                '     </div>\n' +
                '</div>',
                footer: '<div class="file-thumbnail-footer">\n' +
                '    <div class="file-caption-name" style="width:{width}">{caption}</div>\n' +
                '    {progress} {actions}\n' +
                '</div>',
                actions: '<div class="file-actions">\n' +
                '    <div class="file-footer-buttons">\n' +
                '        {delete} {zoom} {other}' +
                '    </div>\n' +
                '    {drag}\n' +
                '    <div class="file-upload-indicator" title="{indicatorTitle}">{indicator}</div>\n' +
                '    <div class="clearfix"></div>\n' +
                '</div>',
                actionDelete: '<button type="button" class="kv-file-remove {removeClass}" title="{removeTitle}"{dataUrl}{dataKey}>{removeIcon}</button>\n',
                actionZoom: '<button type="button" class="kv-file-zoom {zoomClass}" title="{zoomTitle}">{zoomIcon}</button>',
                actionDrag: '<span class="file-drag-handle {dragClass}" title="{dragTitle}">{dragIcon}</span>'

            },
            maxFileCount: 1,
            showUpload:false
        };


        $("#logo").fileinput(config);

        $("#card").fileinput(config);
        $("#license").fileinput(config);

    });
</script>
</body>
</html>
